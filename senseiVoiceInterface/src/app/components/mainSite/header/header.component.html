<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container">
    <a class="navbar-brand" href="#" (click)="navigateToHome(); $event.preventDefault()">
      <div class="logo-box">
        <img 
          src="assets/img/CASTINGVOIXOFF_Plan de travail 1 copie 5.png" 
          style="width: 100%" 
          [alt]="'header.logo.alt' | translate">
      </div>
    </a>

    <button 
      class="navbar-toggler" 
      type="button" 
      data-bs-toggle="collapse" 
      data-bs-target="#navbarNav"
      [attr.aria-label]="'header.navigation.toggleMenu' | translate">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
      <ul class="navbar-nav mx-auto">
        <!-- Voice Language Filter Dropdown -->
        <li class="nav-item">
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a 
                class="nav-link dropdown-toggle" 
                href="javascript:void(0)" 
                id="languageDropdown" 
                role="button"
                (click)="toggleLanguageDropdown()"
                [attr.aria-label]="'header.navigation.voiceLanguages' | translate">
                {{ 'header.navigation.languages' | translate }}
              </a>
              <ul class="dropdown-menu language-dropdown" [class.show]="isLanguageDropdownOpen">
                <li *ngFor="let lang of voiceLanguages">
                  <a class="dropdown-item" (click)="selectVoiceLanguage(lang.code)">
                    {{ lang.nativeName }}
                    <span class="text-muted ms-2">({{ lang.name | translate }})</span>
                  </a>
                </li>
              </ul>              
            </li>
          </ul>
        </li>

        <!-- Main Navigation Links -->
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="actors" 
             (click)="navigateToActors()">
            {{ 'header.navigation.speakers' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="voice-ai" 
             (click)="navigateToVoiceAI()">
            {{ 'header.navigation.aiVoice' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="humain-voices" 
             (click)="navigateToHumanVoices()">
            {{ 'header.navigation.humanVoice' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="studio" 
             (click)="navigateToStudio()">
            {{ 'header.navigation.studio' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" 
             routerLink="contact" 
             (click)="navigateToContact()">
            {{ 'header.navigation.contact' | translate }}
          </a>
        </li>
      </ul>

      <!-- Right side: UI Language Selector + Auth Section -->
      <div class="d-flex align-items-center">
        <!-- UI Language Selector -->
        <div class="nav-item dropdown me-3">
          <a 
            class="nav-link dropdown-toggle" 
            href="javascript:void(0)" 
            id="uiLanguageDropdown" 
            role="button"
            data-bs-toggle="dropdown"
            [attr.aria-label]="'header.uiLanguage.selector' | translate">
            <i class="bi bi-globe me-1"></i>
            {{ getUILanguageDisplayName() }}
          </a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="uiLanguageDropdown">
            <li>
              <a class="dropdown-item" 
                 href="#" 
                 (click)="changeUILanguage('en'); $event.preventDefault()"
                 [class.active]="getCurrentUILanguage() === 'en'">
                ğŸ‡ºğŸ‡¸ {{ 'header.uiLanguage.options.english' | translate }}
              </a>
            </li>
            <li>
              <a class="dropdown-item" 
                 href="#" 
                 (click)="changeUILanguage('fr'); $event.preventDefault()"
                 [class.active]="getCurrentUILanguage() === 'fr'">
                ğŸ‡«ğŸ‡· {{ 'header.uiLanguage.options.french' | translate }}
              </a>
            </li>
            <li>
              <a class="dropdown-item" 
                 href="#" 
                 (click)="changeUILanguage('es'); $event.preventDefault()"
                 [class.active]="getCurrentUILanguage() === 'es'">
                ğŸ‡ªğŸ‡¸ {{ 'header.uiLanguage.options.spanish' | translate }}
              </a>
            </li>
          </ul>
        </div>

        <!-- Conditional rendering based on authentication state -->
        <!-- Show when user is NOT logged in -->
        <ng-container *ngIf="!isLoggedIn; else userAvatar">
          <a routerLink="login" 
             class="nav-link me-3" 
             (click)="navigateToLogin()">
            {{ 'header.auth.login' | translate }}
          </a>
          <a class="btn btn-signup dropdown-toggle"
     href="javascript:void(0)"
     id="signupDropdown"
     role="button"
     data-bs-toggle="dropdown"
     aria-expanded="false">
    {{ 'header.auth.signup' | translate }}
  </a>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="signupDropdown">
    <li>
      <a class="dropdown-item" href="javascript:void(0)">
        Client
      </a>
    </li>
    <li>
      <a class="dropdown-item" href="javascript:void(0)">
        Speaker
      </a>
    </li>
  </ul>
        </ng-container>

        <!-- Show when user IS logged in -->
        <ng-template #userAvatar>
          <div class="user-avatar-dropdown">
            <div class="avatar-container" 
                 (click)="toggleUserDropdown()"
                 [attr.aria-label]="'header.userMenu.toggle' | translate">
              <img
                [src]="'assets/img/png-clipart-computer-icons-avatar-avatar-web-design-heroes.png'"
                [alt]="'header.userMenu.avatar' | translate"
                class="user-avatar"
              >
              <span class="ms-2 d-none d-md-inline">{{ getUserDisplayName() }}</span>
              <i class="bi bi-chevron-down ms-1"></i>
            </div>

            <!-- User dropdown menu -->
            <div class="user-dropdown" [class.show]="isUserDropdownOpen">
              <a href="#" 
                 class="dropdown-item" 
                 (click)="navigateToProfile(); $event.preventDefault()">
                <i class="bi bi-person me-2"></i>
                {{ 'header.userMenu.profile' | translate }}
              </a>
              <a href="#" 
                 class="dropdown-item" 
                 (click)="navigateToDashboard(); $event.preventDefault()">
                <i class="bi bi-speedometer2 me-2"></i>
                {{ 'header.userMenu.dashboard' | translate }}
              </a>
              <a href="#" 
                 class="dropdown-item" 
                 (click)="navigateToSettings(); $event.preventDefault()">
                <i class="bi bi-gear me-2"></i>
                {{ 'header.userMenu.settings' | translate }}
              </a>
              <div class="dropdown-divider"></div>
              <a href="javascript:void(0)" 
                 class="dropdown-item text-danger" 
                 (click)="logout()">
                <i class="bi bi-box-arrow-right me-2"></i>
                {{ 'header.userMenu.logout' | translate }}
              </a>
            </div>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</nav>
