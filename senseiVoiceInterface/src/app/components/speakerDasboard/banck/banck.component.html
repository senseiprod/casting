<div class="modern-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">
        <i class="bi bi-heart-fill me-2"></i>
        Favorite Voices
      </h1>
      <p class="page-subtitle">Browse and manage your collection of favorite voices</p>
    </div>
  </div>

  <!-- Filter Controls -->
  <div class="filter-section">
    <div class="filter-card">
      <div class="filter-header">
        <h3 class="filter-title">
          <i class="bi bi-funnel me-2"></i>
          Voice Filters
        </h3>
      </div>
      <div class="filter-grid">
        <!-- Language Filter -->
        <div class="filter-group">
          <label class="filter-label">
            <i class="bi bi-globe me-1"></i>
            {{ 'voiceCasting.filters.language' | translate }}
          </label>
          <select
            class="filter-select"
            [value]="selectedLanguage"
            (change)="filterByLanguage($event)">
            <option *ngFor="let language of languages" [value]="language.code">
              {{ language.name }}
            </option>
          </select>
        </div>

        <!-- Accent Filter -->
        <div class="filter-group">
          <label class="filter-label">
            <i class="bi bi-mic me-1"></i>
            {{ 'voiceCasting.filters.accent' | translate }}
          </label>
          <select
            class="filter-select"
            [value]="selectedAccent"
            (change)="filterByAccent($event)">
            <option *ngFor="let accent of accents" [value]="accent.code">
              {{ accent.name }}
            </option>
          </select>
        </div>

        <!-- Age Filter -->
        <div class="filter-group">
          <label class="filter-label">
            <i class="bi bi-person me-1"></i>
            {{ 'voiceCasting.filters.age' | translate }}
          </label>
          <select
            class="filter-select"
            [value]="selectedAge"
            (change)="filterByAge($event)">
            <option *ngFor="let age of ages" [value]="age.code">
              {{ age.name }}
            </option>
          </select>
        </div>

        <!-- Gender Filter -->
        <div class="filter-group">
          <label class="filter-label">
            <i class="bi bi-gender-ambiguous me-1"></i>
            {{ 'voiceCasting.filters.gender' | translate }}
          </label>
          <select
            class="filter-select"
            [value]="selectedGender"
            (change)="filterByGender($event)">
            <option *ngFor="let gender of genders" [value]="gender.code">
              {{ gender.name }}
            </option>
          </select>
        </div>

        <!-- Category Filter -->
        <div class="filter-group">
          <label class="filter-label">
            <i class="bi bi-tags me-1"></i>
            {{ 'voiceCasting.filters.category' | translate }}
          </label>
          <select
            class="filter-select"
            [value]="selectedCategory"
            (change)="filterByCategory($event)">
            <option *ngFor="let category of categories" [value]="category.code">
              {{ category.name }}
            </option>
          </select>
        </div>

        <!-- Page Size Selector -->
        <div class="filter-group">
          <label class="filter-label">
            <i class="bi bi-grid me-1"></i>
            {{ 'voiceCasting.filters.voicesPerPage' | translate }}
          </label>
          <select
            class="filter-select"
            [value]="pageSize"
            (change)="onPageSizeChange($event)">
            <option *ngFor="let size of pageSizeOptions" [value]="size">{{ size }}</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Active Filters -->
  <div class="active-filters" *ngIf="selectedLanguage || selectedAccent || selectedAge || selectedGender || selectedCategory">
    <div class="active-filters-card">
      <div class="active-filters-header">
        <span class="active-filters-title">
          <i class="bi bi-funnel-fill me-1"></i>
          {{ 'voiceCasting.filters.activeFilters' | translate }}
        </span>
        <button class="clear-all-btn" (click)="resetFilters()">
          <i class="bi bi-x-circle me-1"></i>
          Clear All
        </button>
      </div>
      <div class="active-filters-list">
        <span class="filter-badge" *ngIf="selectedLanguage">
          <i class="bi bi-globe me-1"></i>
          {{ selectedLanguage }}
          <button class="remove-filter" (click)="filterByLanguage('')">
            <i class="bi bi-x"></i>
          </button>
        </span>
        <span class="filter-badge" *ngIf="selectedAccent">
          <i class="bi bi-mic me-1"></i>
          {{ selectedAccent }}
          <button class="remove-filter" (click)="filterByAccent('')">
            <i class="bi bi-x"></i>
          </button>
        </span>
        <span class="filter-badge" *ngIf="selectedAge">
          <i class="bi bi-person me-1"></i>
          {{ selectedAge }}
          <button class="remove-filter" (click)="filterByAge('')">
            <i class="bi bi-x"></i>
          </button>
        </span>
        <span class="filter-badge" *ngIf="selectedGender">
          <i class="bi bi-gender-ambiguous me-1"></i>
          {{ selectedGender }}
          <button class="remove-filter" (click)="filterByGender('')">
            <i class="bi bi-x"></i>
          </button>
        </span>
        <span class="filter-badge" *ngIf="selectedCategory">
          <i class="bi bi-tags me-1"></i>
          {{ selectedCategory }}
          <button class="remove-filter" (click)="filterByCategory('')">
            <i class="bi bi-x"></i>
          </button>
        </span>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="loading-card">
      <div class="loading-spinner">
        <div class="spinner"></div>
      </div>
      <h3 class="loading-title">{{ 'voiceCasting.loading' | translate }}</h3>
      <p class="loading-subtitle">Finding your favorite voices...</p>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && voices.length === 0" class="empty-state">
    <div class="empty-card">
      <div class="empty-icon">
        <i class="bi bi-heart"></i>
      </div>
      <h3 class="empty-title">{{ 'voiceCasting.noVoicesFound' | translate }}</h3>
      <p class="empty-subtitle">{{ 'voiceCasting.tryDifferentFilters' | translate }}</p>
      <button class="reset-btn" (click)="resetFilters()">
        <i class="bi bi-arrow-clockwise me-2"></i>
        {{ 'voiceCasting.resetFilters' | translate }}
      </button>
    </div>
  </div>

  <!-- Voice Grid -->
  <div class="voices-grid" *ngIf="!isLoading && voices.length > 0">
    <div class="voice-card" *ngFor="let voice of voices">
      <div class="voice-card-inner">
        <!-- Voice Header -->
        <div class="voice-header">
          <div class="voice-avatar-container">
            <div class="voice-avatar">
              <img
                *ngIf="voice.gender === 'male'"
                [src]="'assets/img/avatar men.png'"
                alt="Male voice profile"
                class="avatar-image"
              >
              <img
                *ngIf="voice.gender === 'female'"
                [src]="'assets/img/avatar women.png'"
                alt="Female voice profile"
                class="avatar-image"
              >
              <img
                *ngIf="!voice.gender || (voice.gender !== 'male' && voice.gender !== 'female')"
                [src]="'https://api.dicebear.com/7.x/initials/svg?seed=' + voice.name"
                alt="Voice profile"
                class="avatar-image"
              >
              <div class="avatar-overlay">
                <button
                  class="play-btn"
                  (click)="playVoice(voice)"
                  [class.playing]="currentPlayingVoiceId === voice.voice_id">
                  <i *ngIf="currentPlayingVoiceId !== voice.voice_id" class="bi bi-play-fill"></i>
                  <i *ngIf="currentPlayingVoiceId === voice.voice_id" class="bi bi-pause-fill"></i>
                </button>
              </div>
            </div>
          </div>
          
          <div class="voice-info">
            <div class="voice-name-row">
              <h3 class="voice-name">{{ voice.name }}</h3>
              <button
                class="favorite-btn"
                (click)="toggleFavoriteVoice(voice)"
                [class.favorited]="isFavorite(voice)">
                <i class="bi bi-heart-fill"></i>
              </button>
            </div>
            <p class="voice-description">
              {{ voice.description | slice:0:80 }}{{ voice.description?.length > 80 ? '...' : '' }}
            </p>
          </div>
        </div>

        <!-- Audio Waveform -->
        <div class="audio-waveform" [class.active]="currentPlayingVoiceId === voice.voice_id">
          <div class="waveform-bars">
            <div class="wave-bar" *ngFor="let i of [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]"
                 [style.height.%]="getRandomHeight(i)"
                 [style.animation-delay.ms]="i * 100"></div>
          </div>
        </div>

        <!-- Voice Tags -->
        <div class="voice-tags">
          <span class="voice-tag" *ngIf="voice.language">
            <i class="bi bi-globe me-1"></i>
            {{ voice.language }}
          </span>
          <span class="voice-tag" *ngIf="voice.accent">
            <i class="bi bi-mic me-1"></i>
            {{ voice.accent }}
          </span>
          <span class="voice-tag" *ngIf="voice.age">
            <i class="bi bi-person me-1"></i>
            {{ voice.age }}
          </span>
          <span class="voice-tag" *ngIf="voice.gender">
            <i class="bi bi-gender-ambiguous me-1"></i>
            {{ voice.gender }}
          </span>
        </div>

        <!-- Generate Button -->
        <div class="voice-actions">
          <a class="generate-btn" [href]="'speakerDasboard/' + uuid">
            <i class="bi bi-soundwave me-2"></i>
            {{ 'voiceCasting.generate' | translate }}
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div class="pagination-section" *ngIf="!isLoading && voices.length > 0">
    <div class="pagination-info">
      <div class="voices-count">
        <i class="bi bi-heart-fill me-2"></i>
        <span class="count-number">{{ totalVoices }}</span>
        <span class="count-label">{{ 'voiceCasting.voicesFound' | translate }}</span>
      </div>
      <div class="page-info">
        {{ 'voiceCasting.page' | translate }} {{ currentPageIndex + 1 }}
      </div>
    </div>

    <div class="pagination-controls">
      <button
        class="pagination-btn"
        (click)="firstPage()"
        [disabled]="currentPageIndex === 0">
        <i class="bi bi-chevron-double-left"></i>
      </button>
      <button
        class="pagination-btn"
        (click)="prevPage()"
        [disabled]="currentPageIndex === 0">
        <i class="bi bi-chevron-left"></i>
      </button>
      <span class="current-page">{{ currentPageIndex + 1 }}</span>
      <button
        class="pagination-btn"
        (click)="nextPage()"
        [disabled]="!hasMorePages">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </div>
</div>
