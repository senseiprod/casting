<!-- Header -->
<header class="topbar">
  <div class="header-container">
    <!-- Left Section: Toggle & Title -->
    <div class="header-left">
      <div class="page-title">
        <h1>{{ 'header.title' | translate }}</h1>
        <div class="breadcrumb">
          <span>{{ 'header.breadcrumb.home' | translate }}</span>
          <i class="bi bi-chevron-right separator"></i>
          <span class="current">{{ 'header.breadcrumb.dashboard' | translate }}</span>
        </div>
      </div>
    </div>

    <!-- Right Section: Actions & Profile -->
    <div class="header-right">
      <!-- Search -->
      <div class="search-container d-none d-lg-flex">
        <div class="search-box">
          <i class="bi bi-search search-icon"></i>
          <input 
            type="text" 
            [placeholder]="'header.search.placeholder' | translate" 
            class="search-input"
            #searchInput
            (keyup.enter)="onSearchSubmit(searchInput.value)">
        </div>
      </div>

      <!-- Language Selector -->
      <div class="language-selector">
        <div class="dropdown">
          <button 
            class="language-button" 
            type="button" 
            id="languageDropdown" 
            data-bs-toggle="dropdown" 
            aria-expanded="false"
            [attr.aria-label]="'header.language.selector' | translate">
            <i class="bi bi-globe"></i>
            <span>{{ getLanguageDisplayName() }}</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="languageDropdown">
            <li>
              <a class="dropdown-item" 
                 href="#" 
                 (click)="changeLanguage('en'); $event.preventDefault()"
                 [class.active]="getCurrentLanguage() === 'en'">
                <span class="language-flag">ðŸ‡ºðŸ‡¸</span> 
                {{ 'header.language.options.english' | translate }}
              </a>
            </li>
            <li>
              <a class="dropdown-item" 
                 href="#" 
                 (click)="changeLanguage('fr'); $event.preventDefault()"
                 [class.active]="getCurrentLanguage() === 'fr'">
                <span class="language-flag">ðŸ‡«ðŸ‡·</span> 
                {{ 'header.language.options.french' | translate }}
              </a>
            </li>
            <li>
              <a class="dropdown-item" 
                 href="#" 
                 (click)="changeLanguage('es'); $event.preventDefault()"
                 [class.active]="getCurrentLanguage() === 'es'">
                <span class="language-flag">ðŸ‡ªðŸ‡¸</span> 
                {{ 'header.language.options.spanish' | translate }}
              </a>
            </li>
          </ul>
        </div>
      </div>

      <!-- Notifications -->
      <div class="notification-container">
        <div class="dropdown">
          <button 
            class="notification-button" 
            id="notificationsDropdown" 
            data-bs-toggle="dropdown" 
            aria-expanded="false"
            [attr.aria-label]="'header.notifications.button' | translate">
            <i class="bi bi-bell"></i>
            <span class="notification-badge" *ngIf="notificationCount > 0">{{ notificationCount }}</span>
          </button>
          <div class="dropdown-menu dropdown-menu-end notification-dropdown" aria-labelledby="notificationsDropdown">
            <div class="notification-header">
              <h6>{{ 'header.notifications.title' | translate }}</h6>
              <a href="#" 
                 class="mark-all" 
                 (click)="markAllNotificationsAsRead(); $event.preventDefault()">
                {{ 'header.notifications.markAllRead' | translate }}
              </a>
            </div>
            <div class="notification-body">
              <div *ngIf="notifications.length === 0" class="no-notifications">
                <p>{{ 'header.notifications.noNotifications' | translate }}</p>
              </div>
              <a href="#" 
                 class="notification-item" 
                 *ngFor="let notification of notifications"
                 [class.unread]="notification.unread"
                 (click)="markNotificationAsRead(notification.id); $event.preventDefault()">
                <div class="notification-icon">
                  <i [class]="notification.icon"></i>
                </div>
                <div class="notification-content">
                  <p class="notification-text">{{ notification.text | translate }}</p>
                  <p class="notification-time">{{ notification.time | translate }}</p>
                </div>
              </a>
            </div>
            <div class="notification-footer">
              <a href="#" 
                 class="view-all" 
                 (click)="navigateToNotifications(); $event.preventDefault()">
                {{ 'header.notifications.viewAll' | translate }}
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- User Profile -->
      <div class="profile-container">
        <div class="dropdown">
          <button 
            class="profile-button" 
            id="userDropdown" 
            data-bs-toggle="dropdown" 
            aria-expanded="false"
            [attr.aria-label]="'header.profile.menu' | translate">
            <div class="profile-avatar">
              <img 
                [src]="profilePhotoUrl || 'assets/img/png-clipart-computer-icons-avatar-avatar-web-design-heroes.png'" 
                [alt]="'header.profile.avatar' | translate">
              <span class="status-indicator" [attr.title]="'header.profile.status.online' | translate"></span>
            </div>
            <div class="profile-info d-none d-md-block">
              <h6 class="profile-name">{{ speaker?.prenom }} {{ speaker?.nom }}</h6>
              <p class="profile-role">{{ speaker?.code }}</p>
            </div>
            <i class="bi bi-chevron-down profile-arrow"></i>
          </button>

          <div class="dropdown-menu dropdown-menu-end profile-dropdown" aria-labelledby="userDropdown">
            <div class="dropdown-header">
              <h6>{{ speaker?.prenom }} {{ speaker?.nom }}</h6>
              <p>{{ speaker?.code }}</p>
            </div>

            <div class="dropdown-body">
              <a class="dropdown-item" 
                 routerLink="profile"
                 (click)="navigateToProfile()">
                <i class="bi bi-person"></i>
                <span>{{ 'header.profile.menu.myProfile' | translate }}</span>
              </a>
              <a class="dropdown-item" 
                 routerLink="setting"
                 (click)="navigateToSettings()">
                <i class="bi bi-gear"></i>
                <span>{{ 'header.profile.menu.accountSettings' | translate }}</span>
              </a>
              <a class="dropdown-item" href="#">
                <i class="bi bi-shield-check"></i>
                <span>{{ 'header.profile.menu.privacySecurity' | translate }}</span>
              </a>
              <a class="dropdown-item" href="#">
                <i class="bi bi-question-circle"></i>
                <span>{{ 'header.profile.menu.helpSupport' | translate }}</span>
              </a>
            </div>

            <div class="dropdown-footer">
              <a class="dropdown-item logout-item" 
                 href="#" 
                 (click)="logout(); $event.preventDefault()">
                <i class="bi bi-box-arrow-right"></i>
                <span>{{ 'header.profile.menu.logout' | translate }}</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>
